if (self.CavalryLogger) { CavalryLogger.start_js(["0Cw+iuj"]); }

__d("PhotosButtonTooltips",["Arbiter","DOMDimensions","Style","Tooltip"],(function(a,b,c,d,e,f){var g=[],h=[],i;function j(a,c){if(!a||!a.length||!c||!c.length||a.length!=c.length)throw new Error("Incorrect arguments passed in from PHP for photo button cropping");var d=0,e=[],f=!1;for(d=0;d<a.length;d++)e.push(b("DOMDimensions").getElementDimensions(a[d]).width),e[d]&&(f=!0);if(f){a.forEach(function(a){b("Style").set(a,"max-width","100%")});for(d=0;d<a.length;d++){var g=a[d],i=e[d];if(i){var j=b("DOMDimensions").getElementDimensions(g).width;j>i&&(b("Tooltip").set(g,c[d]),h.push(g))}}a.forEach(function(a){b("Style").set(a,"max-width","")})}return f}function k(){g.forEach(function(a){a.unsubscribe()}),g=[],h.forEach(b("Tooltip").remove),h=[]}function l(a,c,d){this.arbiterToken=b("Arbiter").subscribe(a,function(){j(c,d)&&(this.arbiterToken&&this.arbiterToken.unsubscribe())}.bind(this))}a={init:function(){i||(i=b("Arbiter").subscribe("PhotoSnowlift.CLOSE",k))},registerButtonsOnPaging:function(a,b){g.push(new l("PhotoSnowlift.DATA_CHANGE",a,b).arbiterToken)},registerButtonsOnTaggingOn:function(a,b){g.push(new l("PhotoTagger.START_TAGGING",a,b).arbiterToken)},registerButtonsOnTaggingOff:function(a,b){g.push(new l("PhotoTagger.STOP_TAGGING",a,b).arbiterToken)}};e.exports=a}),null);
__d("XSavedForLaterNUXSeenController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/saved/nuxseen/",{action:{type:"Enum",enumType:1},surface:{type:"Enum",enumType:1},mechanism:{type:"Enum",enumType:1},collection_id:{type:"Enum",enumType:0},object_id:{type:"Int"},interaction_time:{type:"Int"}})}),null);
__d("SavedForLaterChromeExtensionToastNux",["AsyncRequest","Banzai","DataStore","Event","XSavedForLaterNUXSeenController","guid","tidyEvent"],(function(a,b,c,d,e,f){var g="saved_for_later:click",h="impression",i="story",j="chrome_extension_toast_nux",k="SavedForLaterChromeExtensionToastNux",l="chrome_extension_install_link";a=function(){function a(a,c){b("DataStore").set(a,k,this),b("tidyEvent")(b("Event").listen(c,"click",function(a){b("Banzai").post(g,{surface:i,mechanism:l,event_id:b("guid")()},{delay:0})}))}a.onDisplay=function(a){a=b("DataStore").get(a,k);if(!a)return;new(b("AsyncRequest"))(b("XSavedForLaterNUXSeenController").getURIBuilder().setEnum("action",h).setEnum("surface",i).setEnum("mechanism",j).setEnum("collection_id",98).getURI()).setMethod("POST").send()};return a}();e.exports=a}),null);
__d("XSaveAddToCollectionDialogController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/save/list/add_dialog/",{save_context:{type:"String"},story_dom_id:{type:"String"},save_uri:{type:"String"}})}),null);
__d("SaveCaretMenuItem",["csx","cx","AdsTransparencyReportAdTypedLogger","AsyncRequest","Banzai","CSS","DOM","DOMQuery","EntstreamFeedObject","EntstreamFeedObjectFollowup","Event","MenuItem","SaveState","SaveStateHandler","SavedForLaterChromeExtensionToastNux","XSaveAddToCollectionDialogController","ge"],(function(a,b,c,d,e,f,g,h){var i="saved_for_later:caret_action",j="imp",k="._22la";a=function(a){babelHelpers.inheritsLoose(c,a);function c(c){var d;d=a.call(this,c)||this;d._data=d._updateData();d.getRoot();b("Event").listen(d._anchor,"error",d.handleError.bind(babelHelpers.assertThisInitialized(d)));b("SaveStateHandler").listen(c.primarysaveid,function(a){this._data=this._updateData(),this._doRender(a)}.bind(babelHelpers.assertThisInitialized(d)));return d}var d=c.prototype;d.handleClick=function(){var c=this,d=a.prototype.handleClick.call(this),e=babelHelpers["extends"]({},this._data);if(this._data.isSaveAction){var f=b("XSaveAddToCollectionDialogController").getURIBuilder().setString("story_dom_id",this._data.storydomid).setString("save_context",this._data.savecontexttoken).setString("save_uri",this._data.saveajaxify);new(b("AsyncRequest"))().setURI(f.getURI()).setHandler(function(a){a=a.getPayload();a&&!a.dialogShown&&(new(b("AsyncRequest"))().setURI(c._data.saveajaxify).send(),c.showTombstone())}).setErrorHandler(function(){new(b("AsyncRequest"))().setURI(c._data.saveajaxify).send(),c.showTombstone()}).send()}else{b("SaveStateHandler").unsaving(this._data.allsaveids);if(this._data.storydomid!=null){f=b("EntstreamFeedObject").getRoot(b("ge")(this._data.storydomid));var g=b("EntstreamFeedObjectFollowup").getFollowup(f);g&&b("EntstreamFeedObjectFollowup").removeFollowup(f)}}e.logdata.ad_impression&&new(b("AdsTransparencyReportAdTypedLogger"))().setAdID(e.logdata.ad_id).setEvent(e.logdata.event).setEntity(e.logdata.report_entity).setProductLocation(e.logdata.report_location).setSessionID(e.logdata.impression_session_id).setAdsPageType(e.logdata.ads_page_type).log();return d};d.handleError=function(){this._data.isSaveAction?b("SaveStateHandler").saved(this._data.allsaveids):b("SaveStateHandler").unsaved(this._data.allsaveids)};d._updateData=function(){var a=babelHelpers["extends"]({},this._data);a.isSaveAction=b("SaveStateHandler").isSaveAction(a.primarysaveid);a.isSaveAction?(a.markup=a.savemarkup,a.ajaxify="#",a.title=a.savetitle):(a.markup=a.unsavemarkup,a.ajaxify=a.unsaveajaxify,a.title=a.unsavetitle);return a};d._doRender=function(a){if(!this._root)return;switch(a){case b("SaveState").SAVING:case b("SaveState").UNSAVING:b("CSS").addClass(this._root,"_5arm");window.setTimeout(this.disable.bind(this),10);break;case b("SaveState").SAVED:case b("SaveState").UNSAVED:b("CSS").removeClass(this._root,"_5arm");window.setTimeout(this.enable.bind(this),10);break}b("DOM").replace(this._anchor,this._renderItemContent());b("Event").listen(this._anchor,"error",this.handleError.bind(this))};d.onShow=function(){var a=this._data.logdata;b("Banzai").post(i,{action:j,surface:a.surface,story_id:a.story_id,is_save:this._data.isSaveAction})};d.showTombstone=function(){b("SaveStateHandler").saving(this._data.allsaveids);if(this._data.storydomid==null)return;var a=this._data.savefollowupmarkup;this._data.chromeextensionnuxmarkup.hasChildNodes()&&(a=this._data.chromeextensionnuxmarkup,b("SavedForLaterChromeExtensionToastNux").onDisplay(a));var c=b("EntstreamFeedObject").getRoot(b("ge")(this._data.storydomid));if(c){var d=b("DOM").scry(c,"._5va1");if(d&&d.length>0){d=d[0];d&&(c=d)}b("EntstreamFeedObjectFollowup").addFollowup(c,a,["_521o","_4-u3","_3yll"]);d=b("DOMQuery").scry(c,k);if(d.length>0){a=new CustomEvent("savedShow");d[0].dispatchEvent(a)}}};return c}(b("MenuItem"));e.exports=a}),null);